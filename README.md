# Surface-Texture-Analysis-Master's Thesis   
## Abstract   
Surface texture image identification from machining surfaces using image processing techniques has become a popular study topic in recent decades. The goal of this work is to use machine learning approaches to recognise diverse machined surface texture photographs. Images of machined components are captured using a camera from mobile device. Two approaches were used. First was to use a Convolutional Neural Network on the surface images to classify the machining process. In second approach, seven statistical characteristics are extracted from collected photos and a feature vector is created. To derive statistical information from machined metal surface pictures, the Grey Level Co-occurrence Matrix is employed. To describe machined surfaces, four machine learning methods were used: Random Forest, Support Vector Machine, Artificial Neural Network, and J48. It is found that the convolutional approach is not learning properly. Artificial Neural Networks and Random Forests have been proven to have 100\% training accuracy and 99 percent cross validation accuracy. The collected results illustrate the effectiveness of the GLCM technique, which may be used to recognise texture pictures.

## Machining Processes
Cutting parameters, tool geometry, work-piece material, chatter, and cutting fluids all contribute to surface roughness. Of these factors, three important parameters are chosen for each machining process. Three levels of values for each parameter were taken. By varying the combination of parameters and levels, 27 configurations of sets of parameters are obtained for each process. In this experiment, six processes were studied namely Lapping, Reaming, Grinding, Horizontal Milling, Vertical Milling, Turning. Hardened Steel was used for the machining processes.   

## Data Collection and Augmentation
Input images for the model are created by manually taking pictures of the machined surface using a mobile phone. Pictures are taken at 7 different zoom levels for each set of parameters for each process. Camera and the metal work-piece are surrounded by white cardboard to avoid reflection of surroundings. Even the camera angle is adjusted so that even the reflection of the camera on the metal surface is avoided. Then the pictures are manually cropped so that it contains only the machined metal surface. The resulting picture is transformed to a Gray scale level (ranging from 0 to 255), which will aid in further investigation. By using Python OpenCV software program, the obtained original RGB image is converted into gray scale image. These images are further cropped into square images of size 224x224.   

Data augmentation is a term used in data analysis to describe methods for extending the size of a dataset by appending slightly modified copies of current datapoints or by generating new artificial data from old data. It acts as a preprocessing step and helps to prevent overfitting while training a classification model. It is strongly connected to data analysis oversampling. In our experiment, three techniques[Horizontal flip, Vertical flip and Image Rotation] were used. In horizontal flip, images are flipped left to right, while in vertical flip, images are flipped top to bottom. Then copies of those images are rotated at 90$^\circ$ to the axis passing through the image to create further samples of images. To perform a image rotation, we need to create a rotation matrix and then apply affine transform to it. About 100 thousand images were created combining both the processes after the augmentation process.

## GLCM
The relationship between the pictures and pairs of pixels is discovered using GLCM, a statistical approach. GLCM transforms an image into a matrix with the same number of rows and columns as the total number of pixel values in a surface picture. The GLCM matrix represents the occurrence of one grey level appearing in a preset geometric connection with another grey level within the study region. Twelve variations of GLCM were created by varying distances and angles between the pixel pair. Surface feature extraction is the process of extracting features from pictures of metal surfaces using the characteristics and look of the object which is again determined by the roughness, cutting lines, etc. The GLCM is used to compute seven surface characteristics in the current project, which are listed below. With the 12 variations in GLCM and 7 features (Contrast, Dissimilarity, Homogeneity, Entropy, Second Moment, Energy & Correlation) in each GLCM, we get a feature vector of size 84. 

## Models
In surface classification, the pictures are categorised according to the machining processes when a collection of extracted data from pictures, referred as a feature vector, is passed into classification models. While training, the algorithm converts the input data extracted from the pictures to the output label, and it classifies the pictures while testing. In this project, Support Vector Machine(SVM), Decision Tree J48, Random Forest and Artificial Neural network (ANN) are used to classify the texture images. Feature vector obtained from GLCM is fed into each model to train the model and accuracy for each model is obtained.

## Results
The use of computer vision techniques and artificial intelligence algorithms to identify surface texture pictures of machined surfaces is investigated in this work. Computer Vision techniques emerge as a potential decision-making tool for automated inspection. Texture analysis has the advantage of being a non-contact inspection method that can be used for observing tool condition, roughness evaluation, defect sensing, and so on. Convolutional Neural Network approach was able to get a 99\% accuracy on the training set. But it only gave a accuracy of 45\% on the validation set. This shows that the network is overfitting on the training set. It couldn't learn the surface features properly. On the other hand, all the models in the GLCM approach gave accuracy more than 95\%. This shows that the features extracted from the GLCM matrix is highly co-relates to the actual surface features of the image. The methods utilised for feature extraction from GLCM and artificial intelligence algorithms imply a possible use case in industries for the progress of real time characterization of pictures from diverse industrial operations and services, according to the experimental results.
